---
title: 系统架构师笔记
date: 2020-11-19 10:08:59
categories: 读书笔记
tags: [读书笔记]
---

# 第一章 计算机组成与体系结构
## 1.1 计算机系统组成
###  1.1.1 计算机硬件的组成  
&emsp;&emsp;计算机系统由`运算器，控制器，存储器，输入设备，输出设备`五部分组成。
1. 控制器  
控制器是分析和执行指令的部件，也是统一指挥并控制计算机各部件协
调工作的中心部件，所依据的是机器指令。  
控制器的组成包含：
* 程序计数器 PC：存储下一条要执行指令的地址；
* 指令寄存器 IR：存储即将执行的指令；
* 指令译码器 ID：对指令中的操作码字段进行分析解释；
* 时序部件：提供时序控制信号。
2. 运算器  
运算器也称为算术逻辑单元（ArithmeticandLogicUnit，ALU），其主要功能是在控制器的控制下完成各种算术运算和逻辑运算。  
运算器的组成包含：
* 算术逻辑单元 ALU：数据的算术运算和逻辑运算；
* 累加寄存器 AC：通用寄存器，为 ALU 提供一个工作区，用于暂存数据；
* 数据缓冲寄存器 DR：写内存时，暂存指令或数据；
* 状态条件寄存器 PSW：存状态标志与控制标志（争议点：也有将其归为控制器的）。

### 1.1.2 CPU  
1. CPU的功能  
程序控制    :   CPU通过执行指令来控制程序的执行顺序`(重要功能)`  
操作控制    :   一条指令功能的实现需要若干操作信号配合完成，CPU产生每条指令的操作信号并将操作信号送往对应部件  
时间控制    ：  指令执行过程中操作信号的出现时间、持续时间及出现的时间顺序都需要严格控制  
数据处理    ：  通过对数据进行算数运算及逻辑运算等方式进行加工处理`(最根本的任务)`  
还需要对系统内外部的终端做出响应，进行处理。
2. CPU的组成  
1、运算器  
运算器由算数逻辑单元、累加寄存器、数据缓冲寄存器、状态寄存器组成。主要功能有：执行算数运算，执行逻辑运算。  
算数逻辑单元(ALU)：负责处理数据，实现对数据的算术运算和逻辑运算。  
累加寄存器(AC)：为ALU提供工作区。  
数据缓冲寄存器(DR)： 作为CPU和内存、外部设备之间数据传送的中转站；作为CPU和内存、外围设备之间在操作速度上的缓冲。  
状态条件寄存器(PSW)：保存当前指令执行完之后的状态，主要分为状态标识和控制标志。  
2、控制器   
用于控制整个CPU工作过程，决定了计算机运行过程的自动化。 一般包括`指令控制逻辑、时序控制逻辑、总线控制逻辑和终端控制逻辑`几部分。    
指令控制逻辑完成取指令、分析指令、执行指令的操作。  
（1）指令寄存器(IR)：当CPU执行一条指令时，先从内存储器取到缓冲寄存器中，在放到IR中。    
（2）程序计数器(PC)：具有寄存信息和计数两种功能，存储的时要执行的下一条指令的地址。  
（3）地址寄存器(AR)：保存当前CPU所访问的内存单元的地址。  
（4）指令译码器(ID)：对指令中的操作码字段进行分析解释，识别该指令规定的操作，向操作控制器发出具体的控制信号，控制各部件工作，完成所需的功能。  
时序控制逻辑为每条指令按时间顺序提供应有的控制信号。  
总线逻辑是为多个功能部件服务的信息通路的控制电路。  
中断控制逻辑用于控制各种中断请求，并根据优先级的高低对中断请求进行排队。  
3. 多核CPU
优点是可以满足用户同时进行多任务处理的要求。

### 1.1.3 数据表示
1. 原码  
如果机器字长为n，那么原码的定义如下：  
若X是纯整数，则当X是非负数时原码即为X，当X是负数是原码为2^(n-1) + |X|。  
若X是纯小数，则当X是非负数时原码即为X，当X是负数时原码为2^0 + |X|。  
`负数首位为1`
2. 反码
如果机器字长为n，那么反码的定义如下：  
若X是纯整数，则当X是非负数时原码即为X，当X是负数是原码为2^n - 1 + |X|。  
若X是纯小数，则当X是非负数时原码即为X，当X是负数时原码为2-2^-(n-1) + |X|。  
`负数按位取反`
3. 补码
如果机器字长为n，那么补码的定义如下：  
若X是纯整数，则当X是非负数时原码即为X，当X是负数是原码为2^n + |X|。  
若X是纯小数，则当X是非负数时原码即为X，当X是负数时原码为2 + |X|。 
`负数按位取反+1`
4. 移码
在机器字长为n，偏移量为2^(n-1)的情况下，纯整数的移码为2^(n-1)+X,纯小数的移码为1+X。`补码符号位取反即可得到移码`  

### 1.1.4 校验码
计算机通常使用校验码的方法来检测传送的数据是否出问题。  
`码距`:一个编码系统中任意两个合法编码之间至少有多少个二进制位不同  
1. 奇偶校验码  
通过在编码中增加一位校验位来使编码中1的个数为奇数（奇校验）或者偶数（偶校验），从而使码距变为2。  
常见的有：`水平奇偶校验码`，`垂直奇偶校验码`，`水平垂直校验码`
2. 海明码
海明码利用奇偶性来检错和纠错。在数据位之间的特定位置上插入K个校验位，通过扩大码距来实现检错和纠错。
3. 循环冗余校验码
利用多项式为K个数据位产生R个校验位，编码长度K+R记为N，N为CRC码的字长，又称为(n,k)码。  


## 1.2 计算机体系结构
### 1.2.1 计算机体系结构的发展
1. 计算机体系结构的宏观分类  
1、单处理系统：利用一个处理单元与其他外部设备结合起来，实现存储、计算、通信、输入与输出等功能的系统。  
2、并行处理与多处理系统：将两个以上的处理机互连起来，彼此进行通信协调，以便共同求解一个大问题的计算机系统。  
3、分布式处理系统：物理上远距离二松耦合的多计算机系统。  
2. 计算机体系结构的微观分类  
1、Flynn分类法：按指令流和数据流的多少进行分类，可分为单指令流单数据流，单指令流多数据流，多指令流单数据流，多指令流多数据流4类。  
2、冯泽云分类法：按并行度进行分类，可分为字串行位串行，字并行位串行，字串行位并行，字并行位并行4类。  
3、Handler分类法：基于硬件并行程度计算并行度的方法，把计算机硬件分为处理机级，每个处理机中的算逻单元级，每个算逻单元中的逻辑门电路级，分别计算这三级中可以并行或流水处理的程序，来计算系统并行度。  
4、Kuck分类法：用指令流和执行流来描述，分为单指令流单执行流，单指令流多执行流，多指令流单执行流，多指令流多执行流4类。  
3. 指令系统  
一个处理器支持的指令和指令的字节级编码成为其指令集体系结构，有CISC和RISC两种发展途径。  
1、CISC  
CISC的基本思想是进一步增强原有指令的功能，用更为复杂的新指令取代原先由软件子程序完成的功能。`目前使用的绝大多数计算机都属于CISC类型`。  
CSIC的主要弊端如下：  
(1)指令集过分庞杂    
(2)每条复杂指令都要通过执行一段解释性微程序才能完成，降低了处理速度  
(3)指令系统过分庞大，高级语言编译程序选择目标指令的范围很大，并使编译程序本身冗长复杂，难以优化编译生成真正高效的目标代码  
(4)CISC强调完善的中断控制，导致动作繁多、设计复杂、研制周期长  
(5)给芯片设计带来困难，成本提高，成品率低  
2、RISC  
RISC的基本思想是通过减少指令总数和简化指令功能降低硬件设计的复杂度，使指令能单周期运行，并通过优化编译提高指令的执行速度，采用硬布线逻辑优化编译程序。  
RISC的关键技术如下：  
(1)重叠寄存器窗口技术：在处理机中设置一个数量比较大的寄存器堆，并划分为多个窗口  
(2)优化编译技术  
(3)超流水及超标量技术  
(4)硬布线逻辑与微程序相结合在微程序技术中






